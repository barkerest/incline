<table id="dt-users" class="table" style="width: 100%;">
  <thead>
    <tr>
      <th>Name</th>
      <th>Email</th>
      <th>Created</th>
      <th>Comments</th>
      <th></th>
    </tr>
  </thead>
</table>

<% provide :scripts do %>
<script type="text/javascript">
  //<![CDATA[
  $(function() {
    $('#dt-users').DataTable({
      dom: '<"panel-body"<"col-sm-6 col-sm-offset-6"fr>>t<"panel-body"<"col-sm-6"i><"col-sm-6"p>>',
      ajax: {
          url: '<%= api_path %>',
          type: 'POST'
      },
      columns: [
        {
          data: 'name',
          orderable: true,
          searchable: true
        },
        {
          data: 'email',
          orderable: true,
          searchable: true
        },
        {
          data: 'created_at',
          orderable: true,
          searchable: true
        },
        {
          data: 'comments',
          orderable: false,
          searchable: true
        },
        {
          orderable: false,
          searchable: false,
          data: function (row, type, set, meta) {
            if (type === 'display')
            {
              var ret = '<div class="text-right">';
              ret += '<a href="' + row.DT_Path + '" title="Details" class="btn btn-default btn-xs"><i class="glyphicon glyphicon-zoom-in"></i></a>';
              if (row.show_edit) {
                ret += '<a href="' + row.DT_Path + '/edit" title="Edit" class="btn btn-default btn-xs"><i class="glyphicon glyphicon-pencil"></i></a>';
              }
              if (row.show_disable) {
                ret += '<a href="' + row.DT_Path + '/disable" title="Disable" class="btn btn-warning btn-xs"><i class="glyphicon glyphicon-remove-sign"></i></a>';
              } else if (row.show_enable) {
                ret += '<a href="' + row.DT_Path + '/enable" title="Enable" class="btn btn-success btn-xs" data-method="patch"><i class="glyphicon glyphicon-ok-sign"></i></a>';
              }
              if (row.show_delete) {
                ret += '<a href="' + row.DT_Path + '" title="Remove" class="btn btn-danger btn-xs" data-method="delete" data-confirm="Are you sure you want to remove this user?"><i class="glyphicon glyphicon-trash"></i></a>';
              }
              ret += '</div>';

              return ret;
            } else {
              return row.DT_Path;
            }
          }
        }
      ],
      responsive: true,
      serverSide: true
    });
  });
  //]]>
</script>
<% end %>
